 clc
 clearvars

%------------------------------Load Data-----------------------------------
 addpath(genpath('data'))
 load('IEEE14_dc_var_high_red1.mat')
 dataSE = setM{1};
%--------------------------------------------------------------------------
 
 
%-----------------------Design of Iteration Scheme-------------------------
 user.stop = 10^-14;
 user.maxi = 50000;
%--------------------------------------------------------------------------


%-----------------------Convergence Parameters-----------------------------
 user.prob = 0.6;
 user.alph = 0.5;
%--------------------------------------------------------------------------


%------------------------Virtual Factor Nodes------------------------------
 user.mean = 10^-4;
 user.vari = 10^40;
%--------------------------------------------------------------------------


%--------------------------Main Functions----------------------------------
 [sys, bp, wls]  = a1_input_data(dataSE, user);
 [bp, wls, mean] = b1_belief_propagation(bp, user, wls);     
%--------------------------------------------------------------------------