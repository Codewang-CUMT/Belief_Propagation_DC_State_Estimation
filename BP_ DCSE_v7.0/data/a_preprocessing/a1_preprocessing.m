 function  [sys, bp, wls] = a1_preprocessing(dataSE, user)
  
 

%--------------------------Pi Model and Y Bus------------------------------
 tic
 [sys] = a2_pi_model(dataSE.system);
 [sys] = a3_ybus(sys);
%--------------------------------------------------------------------------


%--------------------Number of Variable and Factor Nodes-------------------
 [bp, dataSE] = a4_adjust(sys, dataSE);
%--------------------------------------------------------------------------


%--------------------------Local Factor Nodes------------------------------
 [bp] = a5_local_factor(dataSE.pmu, bp, user);
%--------------------------------------------------------------------------


%------------------------Indirect Factor Nodes-----------------------------
 [bp] = a6_indirect_factor(sys, dataSE.legacy, bp);
%--------------------------------------------------------------------------


%-------------------------Convergence Parameters---------------------------
 [bp] = a7_converg(user, bp);
%--------------------------------------------------------------------------


%-------------------------Expand for BP Summation--------------------------
 [bp] = a8_expand_sum(bp);
%--------------------------------------------------------------------------


%---------------------------------WLS--------------------------------------
 [wls] = a9_wls(sys, dataSE.pmu, bp);
%--------------------------------------------------------------------------


%--------------------------Check Connectivity------------------------------
 [bp] = a10_connect(bp);
%--------------------------------------------------------------------------